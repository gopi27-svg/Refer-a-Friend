<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Refer a Friend</title>
  <link rel="icon" href="data:;base64,iVBORw0KGgo="><!-- suppress 404 favicon -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    *{box-sizing:border-box;margin:0;padding:0;font-family:'Poppins',sans-serif}
    body{background:linear-gradient(to right top,#3b0064,#6f00a3);min-height:100vh;display:flex;justify-content:center;align-items:center;padding:2rem;color:#fff}
    .container{background:rgba(255,255,255,.05);box-shadow:0 8px 32px rgba(0,0,0,.4);border-radius:20px;backdrop-filter:blur(15px);padding:3rem 2rem;width:100%;max-width:600px;animation:fadeIn 1s ease forwards}
    @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    h1{text-align:center;margin-bottom:2rem;font-weight:600;font-size:2rem;color:#ffeaff}
    .field{margin-bottom:1.5rem;position:relative}
    .field input,.field select{width:100%;padding:1rem;border-radius:10px;border:1px solid #ffffff30;background:rgba(255,255,255,.1);color:#fff;font-size:1rem;outline:none;transition:.3s}
    .field input::placeholder,.field select option{color:#ccc}
    .field label{position:absolute;top:-12px;left:12px;background:#6f00a3;padding:0 8px;font-size:.9rem;color:#ffeaff;border-radius:6px}
    button{width:100%;padding:1rem;border:none;border-radius:10px;background:linear-gradient(to right,#a05dff,#c471ed);color:#fff;font-size:1.2rem;font-weight:600;cursor:pointer;transition:background .3s}
    button:hover{background:linear-gradient(to right,#843ae0,#b24cfb)}
    #response{text-align:center;margin-top:1rem;font-size:1rem}
    iframe{display:none;width:0;height:0;border:0}
  </style>
</head>
<body>
  <div class="container">
    <h1>REFER A FRIEND</h1>

    <!-- Hidden target iframe -->
    <iframe name="uploadTarget" id="uploadTarget"></iframe>

    <!-- Action points to your Apps Script Web App -->
    <form id="referralForm" autocomplete="off" novalidate
          action="https://script.google.com/macros/s/AKfycbyUY76sdaBW17LSQ-OsHhHjVzQOq-KTgpy7iAUe2rnmUeAN8mC4Qxf8AfQRM2aD_Zle/exec"
          method="POST"
          enctype="multipart/form-data"
          target="uploadTarget">

      <div class="field">
        <label for="employeeName">EMPLOYEE NAME (Referred by)</label>
        <input type="text" id="employeeName" name="employeeName" required />
      </div>

      <div class="field">
        <label for="referredFor">REFERRED FOR</label>
        <select id="referredFor" name="referredFor" required>
          <option value="" disabled selected hidden style="color:#ccc;">Select Role</option>
        </select>
      </div>

      <div class="field">
        <label for="employeeCode">EMPLOYEE CODE</label>
        <input type="text" id="employeeCode" name="employeeCode" required />
      </div>

      <div class="field">
        <label for="employeeEmail">EMPLOYEE EMAIL ID</label>
        <input type="email" id="employeeEmail" name="employeeEmail" required />
      </div>

      <div class="field">
        <label for="candidateName">CANDIDATE NAME</label>
        <input type="text" id="candidateName" name="candidateName" required />
      </div>

      <div class="field">
        <label for="candidatePhone">CANDIDATE PHONE NO</label>
        <input type="text" id="candidatePhone" name="candidatePhone" required />
      </div>

      <div class="field">
        <label for="candidateLocation">CANDIDATE CURRENT LOCATION</label>
        <input type="text" id="candidateLocation" name="candidateLocation" required />
      </div>

      <div class="field">
        <label for="proposedLocation">PROPOSED LOCATION</label>
        <select id="proposedLocation" name="proposedLocation" required>
          <option value="" disabled selected hidden>Select Location</option>
          <option>Bangalore</option><option>Mumbai</option><option>Pune</option><option>NCR</option>
          <option>Ranchi</option><option>Mysore</option><option>Coimbatore</option><option>Lucknow</option>
          <option>Kochi</option><option>Hyderabad</option><option>Chennai</option><option>Mangalore</option>
          <option>Coimbatore</option>
        </select>
      </div>

      <div class="field">
        <label for="cvFile">CANDIDATE CV (PDF/DOC)</label>
        <input type="file" id="cvFile" name="cvFile" accept=".pdf,.doc,.docx" required />
      </div>

      <button type="submit" id="submitBtn">Submit</button>
      <div id="response"></div>
    </form>
  </div>

  <script>
    // Populate roles
    (function(){
      const roles = [
        "Faculty / Teaching Role",
        "Sales (Inside Sales, Referrals, Channel Sales)",
        "Operation (LEnS, Retention, Biz Ops, Student Onboarding)",
        "Finance and Accounts",
        "Marketing",
        "Business Intelligence (Data Management, Analytics, Reporting)",
        "Centralized Procurement",
        "Content Development and Management (Content & Media)",
        "Human Resources",
        "Learning (DSM / Program Managers)",
        "Certifications",
        "Technology",
        "University Relations"
      ];
      const sel = document.getElementById('referredFor');
      roles.forEach(r => { const o = document.createElement('option'); o.value=r; o.textContent=r; sel.appendChild(o); });
    })();

    const form = document.getElementById('referralForm');
    const responseDiv = document.getElementById('response');
    const submitBtn = document.getElementById('submitBtn');

    form.addEventListener('submit', (e) => {
      const file = document.getElementById('cvFile').files[0];
      if (!file) { e.preventDefault(); msg('‚ùå Please upload a CV file', true); return; }
      const ext = (file.name.split('.').pop()||'').toLowerCase();
      if (!['pdf','doc','docx'].includes(ext)) { e.preventDefault(); msg('‚ùå Only PDF/DOC/DOCX allowed', true); return; }
      responseDiv.textContent = '';
      submitBtn.disabled = true; submitBtn.textContent = 'Submitting...';
    });

    // Listen for Apps Script postMessage
    window.addEventListener('message', (ev) => {
      try {
        const data = typeof ev.data === 'string' ? JSON.parse(ev.data) : ev.data;
        if (data && data.ok) {
          form.innerHTML = `
            <h2 style="text-align:center; color:#bbffbb; margin-top: 2rem;">
              üéâ Referral submitted successfully!
            </h2>
            <p style="text-align:center; color:#bbffbb;">Thank you.</p>
          `;
        } else {
          msg('‚ùå ' + (data && data.error ? data.error : 'Submission failed'), true);
          submitBtn.disabled = false; submitBtn.textContent = 'Submit';
        }
      } catch {
        msg('‚ùå Submission failed', true);
        submitBtn.disabled = false; submitBtn.textContent = 'Submit';
      }
    });

    function msg(text, isError){
      responseDiv.style.color = isError ? '#ff6b6b' : '#fff';
      responseDiv.textContent = text;
    }
  </script>
</body>
</html>
